{% extends "blog/base.html" %}
{% load blog_tags %}

{% block title %}Пошук{% endblock %}

{% block content %}
  <div class="container mt-4">
    <h1 class="mb-4">Пошук публікацій</h1>
    
    <div class="row">
      <div class="col-md-8">
        <form method="get" class="mb-4">
          <div class="input-group">
            {{ form.query }}
            <button class="btn btn-outline-primary" type="submit" id="button-search">
              <i class="bi bi-search"></i> Шукати
            </button>
          </div>
        </form>

        {% if query %}
          <h2 class="h4 mb-3">Результати пошуку для "{{ query }}"</h2>
          
          {% if results %}
            <div class="list-group">
              {% for post in results %}
                <div class="card mb-3">
                  <div class="card-body">
                    <h3 class="h5 card-title">
                      <a href="{{ post.get_absolute_url }}" class="text-decoration-none">
                        {{ post.title }}
                      </a>
                    </h3>
                    <p class="card-text text-muted small">
                      Опубліковано {{ post.publish|date:"d.m.Y" }}
                      {% if post.tags.all %}
                        | Теги: 
                        {% for tag in post.tags.all %}
                          <a href="{% url 'blog:post_list_by_tag' tag.slug %}" class="text-decoration-none">
                            {{ tag.name }}
                          </a>{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                      {% endif %}
                    </p>
                    <div class="card-text">
                      {{ post.body|markdown|truncatewords_html:50 }}
                    </div>
                    <a href="{{ post.get_absolute_url }}" class="btn btn-sm btn-outline-primary mt-2">
                      Читати далі...
                    </a>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="alert alert-info">
              На жаль, за вашим запитом нічого не знайдено.
            </div>
          {% endif %}
        {% else %}
          <div class="alert alert-light">
            Введіть пошуковий запит, щоб знайти потрібні публікації.
          </div>
        {% endif %}
      </div>
      
      <div class="col-md-4">
        {% include "blog/post/sidebar.html" %}
      </div>
    </div>
  </div>
{% endblock %}
